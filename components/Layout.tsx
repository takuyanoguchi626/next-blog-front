import { format } from "date-fns";
import Head from "next/head";
import Link from "next/link";
import { ReactNode, useEffect, useState } from "react";
import { Article } from "../types/Article";

type props = {
  children: ReactNode;
  pastArticles: Article[];
};

export const Layout = (props: props) => {
  const [pastArticleList, setPastArticleList] = useState<Article[]>([
    {
      _id: "1",
      title: "サンプル記事",
      postDate: new Date(),
      editDate: new Date(),
      content:
        "これはサンプルの記事です。SSGの実装が完了したらDBの記事が表示されるようになります。",
    },
    {
      _id: "1",
      title: "サンプル記事",
      postDate: new Date(),
      editDate: new Date(),
      content:
        "これはサンプルの記事です。SSGの実装が完了したらDBの記事が表示されるようになります。",
    },
  ]);

  console.log(props.pastArticles);

  useEffect(() => {
    setPastArticleList(() => props.pastArticles);
  }, []);

  return (
    <div id="Layout">
      <Head>
        <title>takuya Next-blog</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
        <link
          href="https://fonts.googleapis.com/earlyaccess/hannari.css"
          rel="stylesheet"
        ></link>
      </Head>
      <header>
        <Link href={"/"}>
          <a>
            <img className="logo" src="/images/logo2.png" alt="" />
          </a>
        </Link>
        <Link href={"/"}>
          <a>
            <div className="title">Next Blog</div>
          </a>
        </Link>
        <div className="snsImages">
          <img className="sns" src="/images/github.jpg" alt="" />
          <img className="sns" src="/images/twitter.png" alt="" />
          <img className="sns" src="/images/instagram.jpg" alt="" />
        </div>
      </header>
      <div className="topImage">
        <div>NEXT BLOG</div>
        <img src="/images/topImage5.jpg" alt="" />
      </div>
      <main>
        <div className="children">{props.children}</div>
        <div className="profile">
          <div className="profileContents">
            <img src="/images/logo2.png" alt="" />
            <div className="profileText">
              <div className="kanjiName">野口拓也</div>
              <div className="romajiName">Takuya Noguchi</div>
              <div className="job">ITエンジニア</div>
            </div>
          </div>
          <div className="pastArticleList">
            <div className="pastArticleTitle">過去の投稿</div>
            <div className="pastArticles">
              {pastArticleList.map((pastArticle, index) => {
                const formatPostDate = format(
                  new Date(pastArticle.postDate),
                  "yyyy/MM/dd"
                );
                return (
                  <Link href={`/posts/${pastArticle._id}`} key={index}>
                    <a>
                      <div className="pastArticle">
                        <div>{pastArticle.title}</div>
                        <div>{formatPostDate}</div>
                      </div>
                    </a>
                  </Link>
                );
              })}
              <Link href={"/ArticleList"}>
                <a>...もっと見る</a>
              </Link>
            </div>
          </div>
        </div>
      </main>
      <footer>
        <img className="logo" src="/images/logo2.png" alt="" />
        <div className="title">Next-blog</div>
        <div className="btn">
          <button>administrator page</button>
        </div>
      </footer>
    </div>
  );
};
